# 简单的 Windows 10 重装指南
## 目录
- [简单的 Windows 10 重装指南](#简单的-windows-10-重装指南)
	- [前言](#前言)
	- [1. 重装前的准备](#1-重装前的准备)
		- [1.1 文件的备份](#11-文件的备份)
			- [桌面上的文件](#桌面上的文件)
			- [“我的文档”](#我的文档)
			- [浏览器收藏夹](#浏览器收藏夹)
			- [驱动程序](#驱动程序)
			- [其他重要的文件](#其他重要的文件)
		- [1.2 信息的备份](#12-信息的备份)
			- [正版 Windows 激活信息](#正版-windows-激活信息)
			- [正版 Office 激活信息](#正版-office-激活信息)
			- [其他信息](#其他信息)
				- [IP地址、上网账号](#ip地址上网账号)
				- [常用账号和密码](#常用账号和密码)
				- [装在 C 盘的软件列表](#装在-c-盘的软件列表)
				- [环境变量](#环境变量)
	- [重装系统](#重装系统)
		- [2.1 准备系统镜像](#21-准备系统镜像)
		- [2.2 重装系统](#22-重装系统)
		- [2.3 安装系统](#23-安装系统)
	- [后记](#后记)
	- [参考资料（不分先后）](#参考资料不分先后)
## 前言
在写作本文前 10 个小时，我刚刚完成了一次不算完美的 Windows 10 重装。

这篇指南即是根据重装的经验教训，总结写成。

这篇指南面向的目标群体是：

购买了品牌机，电脑上预装有正版 Windows 和 Office，并且已经激活，

由于各种原因希望重装系统，但又害怕重装系统会丢失正版系统和正版 Office 的萌新用户。

是的，有很多这样的电脑用户由于害怕不敢动手重装，宁可将自己的品牌机交给 JS 重装系统，

结果花了钱不说，还被安装了 Ghost 或者类似的备份系统，痛失正版 Windows 和 Office（这两个加起来值将近 2k RMB），

附赠一批国产全家桶，属实血亏。

写作本文的目的是：

在你装系统之前：打消你对重装系统的各种顾虑，同时也避开可能遇到的文件丢失风险；

让你在装完系统以后：

1. 不多出一个以后大概率不会再用的系统 U 盘；
2. 不丢失正版 Windows 和 Office；
3. 不丢失其他重要的文件。

其实这篇指南的内容在网上全都查得到，但是零散在搜索结果的茫茫大海里。

我在这里将这些零碎的教程综合成文，希望能给处在“重装还是不重装，这是个问题”的两难抉择中的萌新们一点帮助。
________________________
## 1. 重装前的准备
### 1.1 文件的备份
#### 桌面上的文件
这句话一定要放在开头说：

等会我们重装系统，**要把 C 盘整个格式化清空，里面的东西就会通通消失。**

不少人对这个问题有不完善的认识，这些人当中，保守的一部分因此恐惧重装系统，自己把自己劝退了；

而激进的一部分则在重装之后，失去了重要的文件追悔莫及。

因此重装系统之前，做好备份是关键。

绝大多数人包括我在内，都不会修改“桌面”的存储路径，因此桌面上的所有东西，实际上都在 C 盘当中，

如果你喜欢把文件放在桌面上，重装系统之前一定要把桌面上所有的重要文件复制到其他盘当中！
#### “我的文档”
这一段的标题“我的文档”其实是众多系统预设文件夹的代表。

[![6pesfS.jpg](https://s3.ax1x.com/2021/02/27/6pesfS.jpg)](https://imgtu.com/i/6pesfS)

看看这些文件夹吧。你或许会说：我从来不往这里面放东西！

但你或许不会想到，很多软件乐于把自己产生的文件往这里面放。

以“文档”文件夹为例，不少单机游戏会把游戏存档放在这里面，比如我电脑上的 [狩猎模拟器](https://baike.baidu.com/item/%E7%8C%8E%E4%BA%BA%EF%BC%9A%E8%8D%92%E9%87%8E%E7%9A%84%E5%8F%AC%E5%94%A4/49838020?fromtitle=%E7%8C%8E%E4%BA%BA%EF%BC%9A%E9%87%8E%E6%80%A7%E7%9A%84%E5%91%BC%E5%94%A4&fromid=20864542)、[真三国无双7](https://baike.baidu.com/item/%E7%9C%9F%E4%B8%89%E5%9B%BD%E6%97%A0%E5%8F%8C7%EF%BC%9A%E7%8C%9B%E5%B0%86%E4%BC%A0)。

办公软件，比如 Adobe 全家桶，就会在“文档”当中放置你的用户设置；

甚至专业软件，例如数学仿真软件 MATLAB，也会在“文档”当中放置文件。

或许上面这些软件你一个都不用，但是我不能保证你电脑上的软件不会往系统预设文件夹里塞东西。

所以你有两个好选择：

1. 在重装系统之前备份这些系统预设文件夹中的文件；
2. 在平时使用电脑的时候，就把这些文件夹的位置移动到其他盘。
#### 浏览器收藏夹
现在还有一些浏览器的收藏夹是放在 C 盘的。

为了避免重装系统以后，面对光秃秃的浏览器搜肠刮肚回忆自己常用的网站，

在重装系统之前要设法备份一下浏览器收藏夹。

操作方法因浏览器种类而异。

某些优秀的浏览器，例如 Chrome 会把收藏夹存在云端，只要登录账号就可以自动同步收藏夹，这就很方便。
#### 驱动程序
这关系到你电脑的各种硬件——网卡声卡蓝牙 USB，各种外设——鼠标键盘耳机麦克风，能不能正常使用。

在这里推荐使用一些专业的驱动软件来备份，例如 [驱动精灵](http://www.drivergenius.com/) 就可以尝试一下。

我本人使用的是 [DISM 工具](https://zhuanlan.zhihu.com/p/30679153) 来备份驱动，重装完成后无法安装备份，报错误代码 50：该命令只能和脱机映像一起使用。

最后我手动安装了 113 个我备份的驱动，属实是一件体力活，但是总好过没有备份。

**虽然 Windows 10 会在联网之后自己安装驱动，主流硬件的驱动都能安装**，

但是在我的电脑上就出现了声卡驱动没装好导致麦克风持续发出巨大的电流声的情况，还是非常吓人的。
#### 其他重要的文件
在点击“格式化 C 盘”之前，你都有机会反复检查 C 盘还有没有你自己安装的重要软件、自己存放的重要文件。

给做平面设计、剪视频等等的设计大佬们提个醒，你电脑上的字体都在 C 盘。

备份的方法很简单：

`Windows 徽标键 + R` 打开“运行”窗口，输入 `Fonts` 按下回车，

打开的文件夹就是存放所有字体的文件夹，全选复制粘贴到其他盘即可。

重装系统完毕之后，找到备份的字体文件，全选，按回车即可安装。
###  1.2 信息的备份
#### 正版 Windows 激活信息
说白了就是你的 Windows 激活 KEY，一串 25 个字符组成的序列。

它在哪呢？

`Windows 徽标键 + R` 打开“运行”窗口，输入 `regedit` 按下回车，打开注册表编辑器。

将下面这一串输入到“注册表编辑器”窗口中，“文件”下方的横栏中：

`HKEY_LOCAL_MACHINE/SOFTWARE/Microsoft/Windows NT/CurrentVersion/SoftwareProtectionPlatform`

选择右侧的“BackupProductKeyDefault”键值，双击打开它。

打开的窗口中下方一栏**“数值数据”里面的 25 位字符就是你的系统激活 KEY，这是你稍后重装系统时激活正版的关键，务必把它记录下来。**

[![6plt41.jpg](https://z3.ax1x.com/2021/02/27/6plt41.jpg)](https://imgtu.com/i/6plt41)

但要注意：对于通过免费升级到 Windows 10 而自动激活的系统，这个密钥没有任何意义,不能用来激活任何系统，重装系统时千万不要输入这样的密钥。

换句话说，只有电脑一到手就是 Windows 10 的系统，才能保留正版 Windows。

免费升级的正版 Windows 10，一重装系统就没了。

考虑到本文前言部分已经说明，本文主要面向品牌机的用户，所以正在读这篇文章的你一般不会遇到这个问题。

> 本段引用自 https://www.windows168.com/win10/10337.html
#### 正版 Office 激活信息
登录你之前用于激活 Office 的微软账户：

https://account.microsoft.com/services/

只要你在这里能看到 Office，它就丢不了。

等会重装系统完毕，只要回到这个页面，点击“安装”

[![6plt41.jpg](https://s3.ax1x.com/2021/02/27/6plt41.jpg)](https://imgtu.com/i/6plt41)

事情就搞定了，保证是正版激活的。

#### 其他信息
##### IP地址、上网账号
如果是固定ip，就有必要抄下来之前的ip地址，子网掩码，网关，DNS等信息。

如果是拨号上网或者需要网页认证的，就把上网的账号和密码记下来，好像有一些软件是可以查看记住密码的上网账号和密码的。

还有你机子上连接的打印机的ip地址，或者是网络共享打印机和文件夹的地址。
##### 常用账号和密码
主要是使用客户端并记住密码的一些软件，有必要抄下来一些账号。
比如 QQ 号，虽然我知道大部分人是记得住的。
##### 装在 C 盘的软件列表
装在 C 盘的一些重要软件，记下他们的名字，以免重装之后想不起来。
##### 环境变量
慎重起见，还是把这个东西备份一下。

因为某些软件依赖于设置好的环境变量，如果环境变量没了，软件就可能不会正常工作。

比如 Minecraft 和杀戮尖塔游戏需要的 Java 运行环境，就属于这种软件。

备份环境变量是非常容易的：

`Windows 徽标键 + R` 打开“运行”窗口，输入 `regedit` 按下回车，打开注册表编辑器。

环境变量在下面两个位置：

系统环境变量：HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Environment 

用户环境变量：HKEY_CURRENT_USER\Environment 

分别定位到系统环境变量和用户环境变量的位置，鼠标右键，在菜单中选择“导出”即可得到两个 reg 文件。

重装系统完毕后，双击这两个文件即可完成环境变量的恢复。

> 本段引用自：https://blog.csdn.net/C_chuxin/article/details/83046365
## 重装系统
### 2.1 准备系统镜像
首先确认一下自己的系统类型。

右键桌面上的“此电脑”，选择“属性”，或者右键开始按钮，“设置” - “系统” - “关于”，在窗口中找找“Windows 规格”。

你一定能看到“Windows 10 家庭中文版”，或者“Windows 10 专业版”之类的字样，这就是系统的类型。

再在同一个地方看一下自己的电脑是 32 位（x86）还是 64 位（x64）。

如果你有 Chrome 浏览器或者其他具有类似“模拟设备”功能的浏览器，

直接打开 https://www.microsoft.com/zh-cn/software-download/windows10ISO/

打开后按下 `F12` 打开开发人员工具，再按下 `Ctrl+Shift+M` 打开模拟设备功能，

在网页顶部的菜单栏“Responsive”处点击，在下拉菜单中选择“iPad”，按 `F5` 刷新网页。

可以看到原来下载 Windows 安装工具的地方变成了“选择版本”。

如果你的电脑预装的系统类型不是 Windows 10 家庭中文版，选择第一个“Windows 10”；

如果是 Windows 10 家庭中文版，选择第二个“Windows 10 家庭中文版”。

接下来选择语言“简体中文”；

如果你的电脑是 32 位（x86），选择 32-bit 下载；64 位（x64）选择 64-bit 下载。

下载以后得到的是一个 iso 镜像文件，将其解压到任何一个除 C 盘以外的盘。

记住解压的路径，因为等一会重装系统的时候我们会用到 Windows 10 内置的 Windows RE 恢复模式来装系统，

那里使用的是命令行，没有图形界面，你需要手工输入这段路径。

我个
人的建议是把系统镜像解压到文件最少的盘的根目录下，原因下面说。
### 2.2 重装系统
激动人心的时刻来了。

一切准备就绪，打开开始菜单，点击“电源”，
 
按住 Shift 键不放，点击“重启”，等电脑进入重启的状态再松开 Shift 键。

你就进入到了 Windows RE。使用这个东西的好处是不需要准备 U 盘启动盘，

从头到尾你的安装不需要借助任何外接的设备，也不必折腾什么 PE，说白了就是省钱省事。

进入 Windows RE 后，依次进入 疑难解答 -> 高级选项 -> 命令提示符 -> 选择你平时登录 Windows 的账号 -> 输入登录密码

注意，在选择命令提示符之后，你的电脑还会再重启一次，所以需要等一会儿才会到选择账号的界面。

进入命令提示符后，输入硬盘的盘符（C: 或 D: 或 E: 之类的）跳转到某个盘，输入 `dir` 查看盘中所有的文件夹。

因为在这个系统当中，硬盘的盘符可能和你平时见到的不一样，比如可能会出现这里的 D 盘对应原先的 E 盘，

所以如果在原先的盘符下找不到解压好的系统镜像，不要惊慌，去其他盘符下找找看。

把系统镜像解压到文件最少的盘的根目录下的目的，就是为了这时候方便找。

找到以后，输入

`cd 你记录的路径`

进入镜像所在的路径，最后输入

`setup.exe`

启动安装程序。

### 2.3 安装系统

进行到这里，我已经可以恭喜你成功了。

安装过程全程都有小娜提示，你只要按提示操作就行。

如果提示输入序列号，那之前记录的 KEY 就会用上。

安装完毕之后进入系统，把之前备份的东西按照我上文写出的方法安装就可以了。
_____________
## 后记
本文是根据回忆整理出来的，写得比较琐碎，又缺乏插图，辛苦各位愿意阅读这么多干巴巴的文字。

感谢知乎、CSDN 和来自一些其他网站的知识分享者们提供的第一手参考资料。

之后如果有时间，我想对本文进行一个概括，浓缩成一个纯干货的 TL;DR 版本方便大家查阅。
## 参考资料（不分先后）
https://zhuanlan.zhihu.com/p/25100540

https://zhuanlan.zhihu.com/p/24832281

https://blog.csdn.net/WPwalter/article/details/86735864

https://blog.csdn.net/C_chuxin/article/details/83046365

https://www.windows168.com/win10/10337.html

https://zhuanlan.zhihu.com/p/30679153
