# 第八章-具有快表的地址变换机构

## 什么是快表

快表，或联想寄存器（Translation Lookaside Buffer），是用于存放最近访问的页表项的副本的 **高速缓存**。

与此相对的，内存中的页表常称为慢表。

## 快表的功能

1. 每次调度一个进程时，清空快表。
2. 该进程每次将要访问逻辑地址时，先做越界检查，保证不越界。
3. 不越界时，先访问快表，若快表内页表项的页号中，包含有这个逻辑地址的页号，直接用快表中的页表项计算物理地址，访问目标页面（访问存取一次，只对目标物理地址）；
4. 若快表中无此页号，则访问慢表，找到慢表中包含这个页号的页表项，将此项存入快表，再计算出物理地址，访问目标页面（访问存取两次，先访问存取慢表，再访问存取目标物理地址）。

如果快表已满，还要依据一定的算法淘汰快表中的页表项。

## 快表带来的性能提升

设访问一次内存时间为 T，访问一次快表时间为 t,

假如系统不支持“快表和慢表同时查找”，必须先查快表，设快表命中率为 p，

其总用时为

p(t+T)+(1-p)(t+T+T) = t+(2-p)T

假如系统支持“快表和慢表同时查找”，那么总用时为

p(t+T)+(1-p)(T+T) = pt+(2-p)T

## 局部性原理

### 时间局部性

因为程序中有大量的循环，

所以某条命令一旦被执行，它不久之后可能就会被再次执行；某个数据一旦被访问，它不久之后可能就会被再次访问。

### 空间局部性

因为很多数据在内存中连续存放，

所以一旦某个数据被访问，不久之后其附近的数据就可能被访问。